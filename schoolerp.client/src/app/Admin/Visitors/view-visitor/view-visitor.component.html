
<div class="container mt-5">
  <!-- Header Section -->
  <div class="row layout-header mb-3">
    <div class="col-md-7">
      <h4 class="font-weight-bold">Appointment List</h4>
    </div>
    <div class="col-md-5 text-right">
      <a routerLink="/visitors/add-visitor" routerLinkActive="active" class="btn btn-outline-primary btn-sm">Book Appointment</a>
    </div>
  </div>


  <app-success-message-popup *ngFor="let message of messages; let i = index"
                             [messages]="message" [showSuccessPopup]="showSuccessPopup"
                             (closePopup)="closeMessagePopup(i)"></app-success-message-popup>


  <!-- Search Section -->
  <div class="row mb-3">
    <div class="col-md-12 text-center">
      <div class="d-flex">
        <input type="text" class="form-control form-control-sm mr-2" #name (input)="filterVisitors(name.value)" placeholder="Search by Name/Phone" id="searchInput">
        <button class="btn btn-primary btn-sm" id="searchButton" (click)="filterVisitors(name.value)">Go</button>
      </div>
    </div>
  </div>

  <!-- Appointment Table -->
  <div class="row mt-3">
    <div class="col-md-12">
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th>#</th>
            <th>Visitor</th>
            <th>Name</th>
            <th>Phone</th> 
            <th>Meeting With</th>
            <th>Appointment Date</th>
            <th>In/Out</th>
            <!--<th>Purpose</th>-->
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="appointmentList"> 
          <!-- Table data rows here as before -->
          <ng-container *ngFor="let v of filteredvisitorList;index as i;">
            <tr class="leave_approved">
              <td rowspan="2">{{i+1}}</td>
              <td rowspan="2" class="image-td"><img [src]="v.visitor_image" /></td>
              <td>{{v.visitor_name}}</td>
              <td>{{v.visitor_contact}}</td>
              <td>{{v.meeting_with}}</td>
              <td>{{v.appointment_date | date: 'dd MMM yyyy'}}</td>
              <td>{{v.check_in_time | date: 'HH:MM'}} - {{v.check_out_time | date: 'HH:MM'}}</td>
              <!--<td>{{v.purpose_of_visit}}</td>-->
              <td>
                <div class="action-container">
                  <button class="btn btn-info btn-sm btn-action" (click)="toggleBtn(i)">Action</button>
                  <ul *ngIf="toggleIndex === i" class="action-list">
                    <li [routerLink]="['/visitors/add-visitor',v.visitor_id]"><i class="fas fa-edit"></i> Edit</li>
                    <li><i class="fas fa-key"></i> Reject</li>
                    <li><i class="fas fa-trash-alt" (click)="deleteVisitor(v.visitor_id)"></i> Delete</li>
                  </ul>
                </div>

              </td>
            </tr>
            <tr class="purpose_div">
              <td colspan="100%" class="fontsmall">
                <b>Purpose : </b>{{v.purpose_of_visit}}
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>
