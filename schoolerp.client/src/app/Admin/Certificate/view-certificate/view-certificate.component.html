
<div class="container mt-4">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h6 class="mb-1">Students List</h6>
      <p class="mb-0 text-muted">View student list</p>
    </div>
    <div>
      <a href="/registration/enquiry" class="btn btn-outline-primary btn-sm me-2">Add Student (Quick)</a>
      <a href="/student/add" class="btn btn-outline-primary btn-sm">Add Student (Detail)</a>
    </div>
  </div>

  <!-- Filters -->
  <div class="row g-3 mb-4">
    <div class="col-md-3">
      <label for="academicFilter" class="form-label">Academic Year</label>
      <select id="academicFilter" class="form-select" [(ngModel)]="selectedSession" (change)="onFilterChange()">
        <option value="">- Select Academic Year -</option>
        <option *ngFor="let s of sessionList;" [value]="s.session_name">{{s.session_name}}</option>
        <!--<option value="2025 - 2026">2025 - 2026</option>-->
      </select>
    </div>

    <div class="col-md-3">
      <label for="classFilter" class="form-label">Class</label>
      <select id="classFilter" class="form-select" [(ngModel)]="selectedClassId" (change)="onClassChange()">
        <option value="0">Select Class</option>
        <option *ngFor="let cls of classList;index as i" [value]="cls.class_id">{{cls.dis_name}}</option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="sectionFilter" class="form-label">Section</label>
      <select id="sectionFilter" class="form-select" [(ngModel)]="selectedSectionId" (change)="onFilterChange()">
        <option value="0">Select Section</option>
        <option *ngFor="let sec of sectionList;index as i" [value]="sec.sec_id">{{sec.sec_dis_name}}</option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="admNoFilter" class="form-label">Admission No</label>
      <input type="text" id="admNoFilter" class="form-control" placeholder="Search by Adm. No" (input)="onFilterChange()" />
    </div>
  </div>

  <!-- Student Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="table-light">
        <tr>
          <th><input type="checkbox" name="checkbox" (change)="changeAllInput($event)" /></th>
          <th>#</th>
          <th>Name</th>
          <th>Father's Name</th>
          <th>Class</th>
          <th>Value <input type="checkbox" name="checkbox" (change)="changeAllReason()" /> <span class="sameFirst">Same as first</span></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let stu of filteredStudentList; index as i">
          <td><input type="checkbox" name="checkbox_{{i}}" [(ngModel)]="stu.checked" [checked]="stu.checked" /></td>
          <td>{{i+1}}</td>
          <td>{{stu.stu_name}}</td>
          <td>{{stu.father_name}}</td>
          <td>{{getClassNameById(selectedClassId)}}</td>
          <td><input type="text" name="remark_{{i}}" [(ngModel)]="stu.remarks" /></td>
        </tr>
        <tr>
          <td colspan="5">
            <div class="d-flex">
              <button class="cbutton m-2" (click)="generatePDF()">Generate Certificate</button>
              <button class="cbutton m-2" (click)="previewCertificates()">Preview Certificates</button>
            </div>
          </td>
        </tr>
        <!-- Add more rows dynamically -->
      </tbody>
    </table>

  </div>
</div>

<div id="certificateTemplate" style="display: none;">
  <div *ngFor="let stu of studentList"
       style="page-break-after: always; padding: 20px; box-sizing: border-box; width: 100%; font-family: Arial, sans-serif;">

    <!-- Header Image -->
    <div style="text-align: center; border:0px; margin-bottom: 20px;">
      <img [src]="template.header"
           crossorigin="anonymous"
           alt="Certificate Header"
           style="width: 100%; border: 0px; height: 100px;" />
    </div>

    <!-- Certificate Body -->
    <div style="border: 1px solid #000; padding: 20px; font-size: 16px; line-height: 1.5;"
         [innerHTML]="replaceMacros(template.template_body, stu)">
    </div>

    <!-- Footer Image -->
    <div style="text-align: center; margin-top: 20px;">
      <img [src]="template.footer"
           crossorigin="anonymous"
           alt="Certificate Footer"
           style="width: 100%; height: 100px; " />
    </div>

  </div>
</div>




