
<div class="container mt-2">
  <!-- Header Section -->
  <div class="row layout-header">
    <div class="col-md-7">
      <h4 class="display-4 text-primary font-weight-bold">Follow-Ups</h4>
    </div>
    <div class="col-md-5 text-right">
      <a routerLink="/counsellor-leads/view-leads" routerLinkActive="active" class="btn btn-outline-primary btn-sm mx-2 shadow-sm">Back to Leads</a>
    </div>
  </div>

  <h6 class="mt-3 text-muted">Follow-Up for Lead ID: <span class="text-info">{{ leadId }}</span></h6>

  <!-- Form to add a new follow-up -->
  <div class="card mt-4 shadow-lg p-4">
    <h5 class="card-title mb-4 text-primary">Add New Follow-Up</h5>
    <form (ngSubmit)="submitFollowup()">
      <div class="form-group">
        <label for="followupDate" class="font-weight-semibold">Follow-Up Date</label>
        <input type="date" class="form-control" id="followupDate" [(ngModel)]="newFollowup.followup_date" name="followup_date" required>
      </div>

      <div class="form-group">
        <label for="followupAction" class="font-weight-semibold">Follow-Up Action</label>
        <textarea class="form-control" id="followupAction" [(ngModel)]="newFollowup.followup_action" name="followup_action" rows="3" required></textarea>
      </div>

      <div class="form-group">
        <label for="followupResult" class="font-weight-semibold">Follow-Up Result</label>
        <textarea class="form-control" id="followupResult" [(ngModel)]="newFollowup.followup_result" name="followup_result" rows="3"></textarea>
      </div>

      <div class="form-group form-check">
        <input type="checkbox" class="form-check-input" id="isActive" [(ngModel)]="newFollowup.isActive" name="isActive">
        <label class="form-check-label" for="isActive">Active Follow-Up</label>
      </div>

      <button type="submit" class="btn btn-primary btn-lg w-100" [disabled]="!newFollowup.followup_date || !newFollowup.followup_action">
        Submit Follow-Up
      </button>
    </form>
  </div>

  <!-- Table to show existing follow-ups for this lead -->
  <div class="mt-5">
    <h5 class="text-primary mb-3">Existing Follow-Ups</h5>
    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead class="thead-dark">
          <tr>
            <th>Follow-Up Date</th>
            <th>Follow-Up Action</th>
            <th>Follow-Up Result</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <!-- Loop through the followups array and display each follow-up -->
          <ng-container *ngIf="followupData.length > 0">
            <tr *ngFor="let followup of followupData">
              <td>{{ followup.followup_date | date:'dd MMM yyyy' }}</td>
              <td>{{ followup.followup_action }}</td>
              <td>{{ followup.followup_result || 'No Result' }}</td>
              <td>
                <span [ngClass]="{'badge badge-success': followup.isActive, 'badge badge-secondary': !followup.isActive}">
                  {{ followup.isActive ? 'Active' : 'Inactive' }}
                </span>
              </td>
            </tr>
          </ng-container>
          <ng-container *ngIf="followupData?.length === 0">
            <tr>
              <td colspan="4" class="text-center text-muted">No follow-ups found.</td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>
