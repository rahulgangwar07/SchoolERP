<div class="container">
  <h6>Define Exam Name</h6>

  <div class="layout-header row">
    <div class="col-md-6">List of Exam Names</div>
    <div class="col-md-6 text-end">
      <a class="view-classes-link" (click)="openModal()">Add Exam Name</a>
    </div>
  </div>

  <table class="table table-striped table-bordered table-hover mt-3">
    <thead>
      <tr class="selected_box text-center">
        <td colspan="100%"><strong>Exam Name List</strong></td>
      </tr>
      <tr>
        <th>#</th>
        <th>Type</th>
        <th>Title</th>
        <th>Order</th>
        <th>Start</th>
        <th>End</th>
        <th>Session</th>
        <th>Options</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let exam of exams; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ getExamTypeName(exam.exam_type_id) }}</td>
        <td>{{ exam.exam_title }}</td>
        <td>{{ exam.order_id }}</td>
        <td>{{ exam.start_date | date: 'yyyy-MM-dd' }}</td>
        <td>{{ exam.end_date | date: 'yyyy-MM-dd' }}</td>
        <td>{{ exam.session }}</td>
        <td>
          <div class="action-container">
            <button class="actionbtn" (click)="toggleAction(i)">Action</button>
            <ul *ngIf="currentIndex === i" class="action-list">
              <li (click)="editExam(exam)"><i class="fas fa-edit"></i> Edit</li>
              <li (click)="deleteExam(exam.exam_name_id,i)"><i class="fas fa-trash-alt"></i> Delete</li>
            </ul>
          </div>
        </td>
      </tr>
    </tbody>

  </table>
</div>

<!-- Modal -->
<div class="modal fade" id="examNameModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form (ngSubmit)="submitForm()">
        <div class="modal-header">
          <h5 class="modal-title">{{ isEditMode ? 'Edit' : 'Add' }} Exam Name</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <!-- Academic Session Field -->
          <div class="form-group mb-2">
            <label for="sessionID" class="col-sm-3 control-label">Academic Session <span class="red">*</span></label>
            <div class="col-sm-6">
              <select name="sessionID" class="form-control" id="sessionID" [(ngModel)]="form.session" required (change)="changeSession()">
                <option value="">Select Academic Session</option>
                <option *ngFor="let sL of sessionList;index as i;" [value]="sL.session_name">{{sL.session_name}}</option>
                <!--<option value="1828" [selected]="examTerm.session === '1828'">2025-2025</option>
        <option value="1829" [selected]="examTerm.session === '1829'">2025-2025</option>-->
              </select>
              <div class="invalid-feedback">Please select an academic session.</div>
            </div>
          </div>

          <div class="form-group mb-2">
            <label>Exam Term</label>
            <select class="form-control" [(ngModel)]="form.term_id" name="term_id" required>
              <option *ngFor="let t of examTerm" [value]="t.exam_term_id">{{ t.term_name }}</option>
            </select>
          </div>

          <div class="form-group mb-2">
            <label>Exam Type</label>
            <select class="form-control" [(ngModel)]="form.exam_type_id" name="exam_type_id" required>
              <option value="0">Select Exam Type</option>
              <option *ngFor="let type of examTypes" [value]="type.exam_type_id">{{ type.exam_type_name }}</option>
            </select>
          </div>

          <div class="form-group mb-2">
            <label>Exam Title</label>
              <input type="text" class="form-control" [(ngModel)]="form.exam_title" name="exam_title" required />
            </div>

            <div class="form-group mb-2">
              <label>Order ID</label>
              <input type="number" class="form-control" [(ngModel)]="form.order_id" name="order_id" required />
            </div>

            <div class="form-group mb-2">
              <label>Start Date</label>
              <input type="date" class="form-control" [(ngModel)]="form.start_date" name="start_date" required />
            </div>

            <div class="form-group mb-2">
              <label>End Date</label>
              <input type="date" class="form-control" [(ngModel)]="form.end_date" name="end_date" required />
            </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">{{ isEditMode ? 'Update' : 'Create' }}</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
