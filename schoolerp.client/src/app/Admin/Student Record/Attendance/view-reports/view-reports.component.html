
<div class="container mt-1">
  <!-- Header Section -->
  <h6>View Student Attendance</h6>
  <div class="row layout-header">
    <div class="col-md-6">
      <p>View student attendance sheet</p>
    </div>
    <div class="col-md-5 text-right">
      <!--<a routerLink="/academics/-correction" routerLinkActive="active" class="action-btn">Export CSV</a>-->
      <a routerLink="/att/monthly-report" routerLinkActive="active" class="action-btn">Report</a>
      <a routerLink="/attendance/take" routerLinkActive="active" class="action-btn">Take Attendance</a>
    </div>
  </div>

  <app-success-message-popup *ngFor="let message of messages; let i = index"
                             [messages]="message" [showSuccessPopup]="showSuccessPopup"
                             (closePopup)="closeMessagePopup(i)">
  </app-success-message-popup>

  <div class="row filtersec">
    <!-- Month Dropdown -->
    <div class="col-md-2">
      <select id="select-month" [(ngModel)]="selectedMonth">
        <option *ngFor="let month of calenderMonth | keyvalue" [value]="month.key">{{ month.value }}</option>
      </select>
    </div>

    <!-- Year Dropdown -->
    <div class="col-md-2">
      <select id="select-year" [(ngModel)]="selectedYear">
        <option *ngFor="let year of calenderYear" [value]="year">{{year}}</option>
      </select>
    </div>

    <!-- Class Dropdown -->
    <div class="col-md-2">
      <select [(ngModel)]="class_id" (change)="changeSubmit()">
        <option value="0">Select</option>
        <option *ngFor="let cls of classList" value="{{cls.class_id}}">
          {{cls.class_name}}
        </option>
      </select>
    </div>

    <!-- Class Dropdown -->
    <div class="col-md-2">
      <select [(ngModel)]="sec_id" (change)="changeSession()">
        <option value="0">Select</option>
        <option *ngFor="let sec of secList" value="{{sec.sec_id}}">
          {{sec.sec_name}}
        </option>
      </select>
    </div>

    <!-- Section Dropdown -->
    <!--<div class="col-md-2">
      <select>
        <option>Section</option>
        <option>A</option>
        <option>B</option>
      </select>
    </div>-->
    <!-- Transport Dropdown -->
    <div class="col-md-2">
      <select>
        <option>Transport</option>
        <option>All Routes</option>
        <option>Bhikampur</option>
        <option>Mukhtarpur</option>
      </select>
    </div>

    <!-- Buttons for SMS -->
    <div class="col-md-6 d-flex">
      <button class="btn-danger">SMS to Absent Student</button>
      <button class="btn-primary" [ngStyle]="{'background-color':themeSetting?.button_color}">SMS to Present Student</button>
    </div>
  </div>

  <!-- Attendance Table Section -->
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title">Attendance DayWise Report</h5>
        </div>
        <div class="card-body">
          <table *ngIf="stu_record && stu_record.name.length>0" class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>Student Name</th>
                <th *ngFor="let att of stu_record.attdays;let i = index">{{ formatDate(att.date) }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let name of stu_record.name; let i = index">
                <td>{{ name }}</td>
                <td *ngFor="let att of stu_record.attdays" [ngClass]="{ 'bgsuccess': att.status[i] == 'P', 'bgdanger': att.status[i] == 'A', 'bgleave': att.status[i] == 'L' }">{{ att.status[i] }}</td>
              </tr>
            </tbody>
          </table>
          <div *ngIf="!stu_record">
            <p>Student Record not found. </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
